%h2 Events and Activities

%p
  In addition to many
  = link_to 'tournaments,', tournaments_path(@year)
  game reviews and lessons by
  = link_to 'professionals,', vip_attendees_path
  the vendor area, and other Go-related activities, we also have
  these activities:

- if current_user.present?
  .flow-padding
    = form_tag choose_attendee_user_path(current_user), :method => "get" do
      = hidden_field_tag :destination_page, :events
      = submit_tag 'Sign Up for Events'
- else
  If you have already 
  = link_to 'registered,', new_user_registration_path
  please
  = link_to 'sign in', new_user_session_path
  and select the events you are interested in.

- if current_user_is_admin?
  .flow-padding= button_to "New Event", new_event_path, :method => "get"

%p.notice All events, prices, and times subject to change.

%table.semantic.fullwidth.zebra
  %tbody
    - @events_by_date.each do |d,arEvt|
      %tr.greater-header
        %th{ :colspan => current_user_is_admin? ? 9 : 7 }
          = d.to_formatted_s(:long_with_day)
          = " - Day Off!" if d === DAY_OFF_DATE
      %tr.lesser-header
        %th
        %th.align-center{:colspan => 2} Leaving
        %th.align-center{:colspan => 2} Returning
        %th{:colspan => current_user_is_admin? ? 4 : 2}
      %tr.lesser-header
        %th Event
        %th Depart
        %th Event Start / Arrive
        %th Depart
        %th Arrive
        %th.numeric Price
        %th Notes
        - if current_user_is_admin?
          %th{:colspan => "2"}
      - arEvt.each do |e|
        %tr
          %td= e.evtname
          %td= e.evtdeparttime
          %td= e.start.to_time.to_formatted_s(:american)
          %td
            - if e.return_depart_time.present?
              = e.return_depart_time.to_formatted_s(:american)
          %td
            - if e.return_arrive_time.present?
              = e.return_arrive_time.to_formatted_s(:american)
          %td.numeric= format_price(e.evtprice)
          %td= e.notes
          - if current_user_is_admin?
            %td= link_to 'Edit', edit_event_path(e)
            %td= link_to 'Delete', e, :confirm => 'Delete event?  If any attendees are signed up, those signups will be lost too.', :method => :delete
%br/
